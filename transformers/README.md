# Multihead transformer

–î–∞–Ω–Ω—ã–π –º–æ–¥—É–ª—å —Å–æ–¥–µ—Ä–∂–∏—Ç —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—é –º–Ω–æ–≥–æ–≥–æ–ª–æ–≤–æ–≥–æ —Ç—Ä–∞–Ω—Å—Ñ–æ—Ä–º–µ—Ä–∞, —Ä–µ—à–∞—é—â–µ–≥–æ –∑–∞–¥–∞—á—É –±–∏–Ω–∞—Ä–Ω–æ–π –∫–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ü–∏–∏ —Ç–µ–∫—Å—Ç–∞

## –û–ø–∏—Å–∞–Ω–∏–µ –º–æ–¥–µ–ª–∏

- –†–µ–∞–ª–∏–∑–æ–≤–∞–Ω —Ç—Ä–∞–Ω—Å—Ñ–æ—Ä–º–µ—Ä —Å –º–Ω–æ–≥–æ–≥–æ–ª–æ–≤—ã–º –º–µ—Ö–∞–Ω–∏–∑–º–æ–º –≤–Ω–∏–º–∞–Ω–∏—è —Å –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç—å—é –∏–∑–º–µ–Ω—è—Ç—å **—á–∏—Å–ª–æ —Å–ª–æ—ë–≤** –∏ **—á–∏—Å–ª–æ –≥–æ–ª–æ–≤ –≤–Ω–∏–º–∞–Ω–∏—è** 
- –û–±—É—á–µ–Ω–∏–µ –º–µ—Ç–æ–¥–æ–º **ADAM** 
- –§—É–Ω–∫—Ü–∏—è –∞–∫—Ç–∏–≤–∞—Ü–∏–∏ - **ReLU**
- –ü—Ä–∏–º–µ–Ω–µ–Ω–∏–µ **–ø–æ–∑–∏—Ü–∏–æ–Ω–Ω–æ–≥–æ –∫–æ–¥–∏—Ä–æ–≤–∞–Ω–∏—è**, **–¥–∏–Ω–∞–º–∏—á–µ—Å–∫–æ–≥–æ –ø—ç–¥–¥–∏–Ω–≥–∞** –∏ **–±–∞—Ç—á-–Ω–æ—Ä–º–∞–ª–∏–∑–∞—Ü–∏–∏**
- **–ü—Ä–µ–¥–æ–±—Ä–∞–±–æ—Ç–∫–∞ –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏–π** –∏ –ø—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏–µ –∏—Ö –≤ —ç–º–±–µ–¥–¥–Ω–∏–≥–∏ —Å –ø–æ–º–æ—â—å—é **Word2Vec**
- –î–ª—è —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–ª–∞—Å—å –º–æ–¥–µ–ª—å —Å 16 –≥–æ–ª–æ–≤–∞–º–∏ –≤–Ω–∏–º–∞–Ω–∏—è –∏ —ç–º–±–µ–¥–¥–∏–Ω–≥–∞–º–∏ —Ä–∞–∑–º–µ—Ä–∞ 100. –†–∞–∑–º–µ—Ä –±–∞—Ç—á–∞ - 100, —á–∏—Å–ª–æ —ç–ø–æ—Ö - 70.

### –†–µ–∞–ª–∏–∑—É–µ–º–∞—è –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞

![Architecture](images/transformer_arch.png)

## –î–∞–Ω–Ω—ã–µ

–î–ª—è —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–ª—Å—è –¥–∞—Ç–∞—Å–µ—Ç –¥–ª—è –∫–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ü–∏–∏ —Ç–æ–∫—Å–∏—á–Ω—ã—Ö –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–µ–≤ —Å —Ñ–æ—Ä—É–º–æ–≤:

üîó [Toxic comments](https://www.kaggle.com/datasets/aybatov/toxic-russian-comments-from-pikabu-and-2ch)

**–í–∞–∂–Ω–æ:** –ø–æ—Å–ª–µ —Å–∫–∞—á–∏–≤–∞–Ω–∏—è –ø–æ–ª–æ–∂–∏—Ç–µ —Ñ–∞–π–ª –≤ –ø–∞–ø–∫—É `data`.

## –ú–µ—Ç—Ä–∏–∫–∏ –∫–∞—á–µ—Å—Ç–≤–∞ –º–æ–¥–µ–ª–∏

| Accuracy | Precision | Recall | F-score |
|----------|-----------|--------|---------|
| 0.816    | 0.708    | 0.768  | 0.737   |

### –ì—Ä–∞—Ñ–∏–∫ –ø–æ—Ç–µ—Ä—å:
![Loss Curve](images/loss_transformer.png)


## –ü—Ä–∏–º–µ—á–∞–Ω–∏–µ

- –ú–µ—Ç—Ä–∏–∫–∏ –æ—Ç—Ä–∞–∂–∞—é—Ç –ª—É—á—à–∏–µ –ø–æ–ª—É—á–µ–Ω–Ω—ã–µ –∑–Ω–∞—á–µ–Ω–∏—è. –ë–æ–ª–µ–µ –ø–æ–¥—Ä–æ–±–Ω—ã–µ —ç–∫—Å–ø–µ—Ä–∏–º–µ–Ω—Ç—ã –∏ –≤–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏–∏ –ø—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω—ã –≤ –Ω–æ—É—Ç–±—É–∫–µ: [`notebooks/test_transformer.ipynb`](../notebooks/test_transformer.ipynb).